#/bin/bash

SITE=$1
TEST=$2

TIME=/usr/bin/time
TIME_TMP=/tmp/check-site-time.txt

RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m' # No Color

SITE_CURL=/tmp/check.tmp

ERROR_404="Page not found"

$TIME -v -o $TIME_TMP curl -sILN  --stderr - $1 > $SITE_CURL;
SITE_STATUS=$(cat $SITE_CURL | grep HTTP | tail -n 1)


#if [[ $SITE_STATUS =~ 200|301|302 ]]
if [[ $SITE_STATUS =~ $TEST ]]
then
    echo -e "$SITE - ${GREEN}Passed${NC}";
else
    echo -e "$SITE - ${RED}Failed${NC} Expected: $TEST Result: ${RED}$SITE_STATUS${NC}";
    cat $SITE_CURL
fi

rm $SITE_CURL
rm $TIME_TMP

